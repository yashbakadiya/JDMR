{% extends 'dashboard/base.html' %}
{% load static %}

{% block main-content %}
<main>
    <div class="mt-5">
    {% if messages %}
    {% for k in messages%}
    <div class="alert alert-{{k.tags}} alert-dismissible fade show" role="alert">
        <b>{{ k }} !</b>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% endfor %}
    {% endif %}
        <div class="card mb-4 ">
            <!-- Grid row -->
            <div class="card-header">
            <div class="row">
                <!-- Grid column -->
                <div class="col-md-8">
                    <h2 style="color: rgb(0, 0, 0);">List of Enrolled Students</h2>
                </div>
                <div class="col-md-4">
                    <input id="searchbox" type="text" class="form-control" name='srh' placeholder="Enter Student Name or Email" required>
                </div>
            </div>
                <!-- Grid column -->
            </div>
            <div class="card-body">
                <!-- Grid row -->
                <div style="overflow-x:scroll;">
                <form action=" " method="post">{% csrf_token %}
                    <!--Table-->
                    <div class="table-responsive">
                    <table class="table table-striped">
                        <!--Table head-->
                            <tr>
                                <th>Student Name</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Email Id</th>
                                <th>Password</th>
                                <th>Phone Number</th>
                                <th>Course Enrolled</th>
                                <th>Class</th>
                                <th class="text-center">Delete</th>
                                <th class="text-center">Update</th>
                                <th class="text-center">Archive</th>
                            </tr>
                        <!--Table head-->
                        <!--Table body-->
                                {% for student,course in students %}
                                    <tr class="main-row">
                                        <td>{{student.student.user.username}}</td>
                                        <td>{{student.student.user.first_name}}</td>
                                        <td>{{student.student.user.last_name}}</td>
                                        <td>{{student.student.user.email}}</td>
                                        <td>{{student.student.user.password}}</td>
                                        <td>{{student.student.phone}}</td>
                                        <td>{{course.courseName}}</td>
                                        <td>{{student.forclass}}</td>
                                        <td class="text-center">
                                            <a href="{% url 'deleteStudent' student.id %}" class="btn btn-danger btn-sm">DELETE</a>
                                        </td>
                                        <td class="text-center">
                                            <a href="{% url 'editStudent' student.id %}" class="btn btn-danger btn-sm">EDIT</a>
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="bigcheckbox" name="check" value="{{student.id}}">
                                        </td>
                                    </tr>
                                {% endfor %}
                        <!--Table body-->
                    </table>
                </div>
                    <!--Table-->
                    <div class="form-group">
                        <input type="submit" value="Move to Archive" class="btn btn-danger float-right">
                    </div>
                    <br>
                </form>
                </div>
                <br>
            </div>
        </div>
</main>
<script type="text/javascript">
    trlist = $(".main-row");
    $("body").on('input',"#searchbox",function(){
        trlist.hide();
        search = this.value.toLowerCase();
        len = search.length;
        for(i=0;i<trlist.length;i++){
          if(trlist[i].children[0].textContent==""){
            cont = cont;
          }
          else{
              cont = trlist[i].children[0].textContent.toLowerCase();
          }
            if(cont.search(search)!=-1){
              $(trlist[i]).show();
            }
        if(trlist[i].children[1].textContent==""){
          cont2 = cont2;
        }
        else{
            cont2 = trlist[i].children[1].textContent.toLowerCase();
        }
          if(cont2.search(search)!=-1){
            $(trlist[i]).show();
          }
        }

    });

</script>
{% endblock main-content %}
