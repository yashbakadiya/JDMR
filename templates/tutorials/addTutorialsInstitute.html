{% extends 'dashboard/base.html' %}
{% load static %}
{% block css %}
@import url('https://fonts.googleapis.com/css?family=Numans');
.container{
height: 100%;
align-content: center;
}
.card{
height: 100%;
margin-top: auto;
margin-bottom: auto;
width: 900px;
background-color: white;
}
.social_icon span{
font-size: 60px;
margin-left: 10px;
color: #FFC312;
}
.social_icon span:hover{
color: white;
cursor: pointer;
}
.card-header h3{
color: white;
}
.social_icon{
position: absolute;
right: 20px;
top: -45px;
}
.input-group-prepend span{
width: 50px;
background-color: #FFC312;
color: black;
border:0 !important;
}
input:focus{
outline: 0 0 0 0 !important;
box-shadow: 0 0 0 0 !important;
}
.remember{
color: white;
}
.remember input
{
width: 20px;
height: 20px;
margin-left: 30px;
margin-right: 15px;
}
.remember1 input
{
width: 20px;
height: 25px;
margin-right: 10px;
}
.login_btn{
color: black;
background-color: #FFC312;
width: 100px;
}
.login_btn:hover{
background-color: #2a2b3d;
color:white;
}
.links{
color: white;
}
.links a{
margin-left: 4px;
}
.bigcheckbox{
width: 20px;
height: 20px;
}
.color-pattern-3 {
text-align: center;
}
/* General button style (reset) */
.button {
border: none;
font-family: inherit;
font-size: inherit;
color: inherit;
background: none;
cursor: pointer;
width: 350px;
padding: 25px 50px;
display: inline-block;
margin: 4px;
text-transform: uppercase;
letter-spacing: 1px;
font-weight: 700;
outline: none;
position: relative;
-webkit-transition: all 0.3s;
-moz-transition: all 0.3s;
transition: all 0.3s;
}
.button:after {
content: '';
position: absolute;
z-index: -1;
-webkit-transition: all 0.3s;
-moz-transition: all 0.3s;
transition: all 0.3s;
}
/* Button 3 */
.button-3 {
background: #fcad26;
color: #fff;
}
.button-3:hover {
background: #f29e0d;
}
.button-3:active {
background: #f58500;
top: 2px;
}
.button-3>.fa {
position: absolute;
height: 100%;
left: 0;
top: 0;
font-size: 140%;
width: 60px;
}
.button-3>.fa:before {
position: absolute;
width: 25px;
height: 25px;
top: 0;
left: 0;
right: 0;
bottom: 0;
margin: auto;
}
/* Button 3a */
.button-3a {
padding: 25px 60px 25px 120px;
}
.button-3a>.fa {
background: rgba(0, 0, 0, 0.05);
}
/* Button 3b */
.button-3b {
padding: 25px 60px 25px 120px;
border-radius: 10px;
}
.button-3b>.fa {
border-right: 2px solid rgba(255, 255, 255, 0.75);
}
/* Button 3c */
.button-3c {
padding: 80px 20px 20px 20px;
border-radius: 10px;
box-shadow: 0 3px #da9622;
}
.button-3c>.fa:before {
position: static;
}
.button-3c:active {
box-shadow: 0 3px #dc7801;
}
.button-3c>.fa {
height: 60px;
width: 100%;
line-height: 60px;
background: #fff;
color: #f29e0d;
border-radius: 10px 10px 0 0;
}
.button-3c:active:before {
color: #f58500;
}
/* Button 3d */
.button-3d {
padding: 25px 60px 25px 120px;
border-radius: 10px;
}
.button-3d>.fa {
background: #fff;
color: #fcad26;
z-index: 2;
border-radius: 10px 0 0 10px;
}
.button-3d:after {
width: 20px;
height: 20px;
background: #fff;
z-index: 1;
left: 55px;
top: 50%;
margin: -10px 0 0 -10px;
-webkit-transform: rotate(45deg);
-moz-transform: rotate(45deg);
-ms-transform: rotate(45deg);
transform: rotate(45deg);
}
.button-3d:active:before {
color: #f58500;
}
.button-3d:active {
top: 0;
}
.button-3d:active:after {
left: 60px;
}
/* Button 3e */
.button-3e {
padding: 25px 120px 25px 60px;
overflow: hidden;
}
.button-3e>.fa {
left: auto;
right: 10px;
z-index: 2;
}
.button-3e:after {
width: 30%;
height: 200%;
background: rgba(255, 255, 255, 0.1);
z-index: 1;
right: 0;
top: 0;
margin: -5px 0 0 -5px;
-webkit-transform-origin: 0 0;
-webkit-transform: rotate(-20deg);
-moz-transform-origin: 0 0;
-moz-transform: rotate(-20deg);
-ms-transform-origin: 0 0;
-ms-transform: rotate(-20deg);
transform-origin: 0 0;
transform: rotate(-20deg);
}
.button-3e:hover:after {
width: 35%;
}
.control-label {
color: rgb(66, 8, 8);
font-size: 20px;
}
[type="checkbox"]
{
vertical-align:middle;
}
[type="radio"]
{
vertical-align:middle;
}
.multiselect-container > li > a > label{
height:auto;
}
.multiselect-container{
height:10rem;
overflow-y:scroll;
width:max-content;
}


{% endblock %}
{% block main-content %}
<div class="mt-5">
    {% if messages %}
    {% for k in messages%}
    <div class="alert alert-{{k.tags}} alert-dismissible fade show" role="alert">
        <b>{{ k }} !</b>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% endfor %}
    {% endif %}
    <div class="card">
        <div class="card-header">
            <div class="row">
                <div class="col-sm">
                    <h2 style="color: rgb(0, 0, 0);">Add Course Tutorials</h2>
                </div>
            </div>
        </div>
        <div class="card-body">
            <form action="" method="post" enctype=multipart/form-data>
                {% csrf_token %}
                <br>
                <div class="row">
                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Class<span
                                class="text-danger">*</span></label>
        
                        <select class="cn custom-select form-control" name="forclass" required
                            onchange="selectclass(this)">
                            <option disabled selected value="">Select an option</option>
                            {% for x in data %}
                            <option value="{{ x.0 }}">{{ x.0 }}</option>
                            {% endfor %}
                        </select>
                    </div>
        
                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Course<span
                                class="text-danger">*</span></label>
        
                        <select class="ctn custom-select form-control" name="course" required>
                            <option disabled selected value="">Select an option</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Course Title<span
                                class="text-danger">*</span></label>
                        <input type="text" class="form-control" name='title' placeholder="Course Title"
                            required="">
                    </div>

                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Course Fees<span
                            class="text-danger">*</span></label>
                            <input type="number" min="0" id="cfees" class="form-control" name='fees' placeholder="Course Fees"
                            required="">
                        </div>

                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Course Duration<span
                                class="text-danger">*</span></label>
                        <input type="number" min="0" class="form-control" name='duration' placeholder="In Months" required>
                    </div>


                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Discount Type</label>

                        <select class="custom-select form-control" name="unit" id="unit">
                            <option selected value="0">In Percentage (%)</option>
                            <option value="1">In Rupees </option>
                        </select>
                    </div>

                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Discount</label>
                        <input type="number" min="0" max="100" step="0.01" class="form-control" id="discount" name='feeDisc'
                            placeholder="Discount">
                    </div>

                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Validity</label>
                        <input type="Date" class="form-control" id="validity" name='discValidity' placeholder="Val" disabled>
                    </div>

                    <div class="col-md-6 col-lg-4 col-12 input-group form-group">
                        <label class="control-label col-sm-5 col-5 mt-2" style="color:black;">Free for Enrolled</label>

                        <select class="custom-select form-control" name="enr">
                            <option selected value="0">No</option>
                            <option value="1">Yes</option>
                        </select>
                    </div>

                    <div class="col-md-12 col-lg-12 col-12 input-group form-group">
                        <textarea type="text" class="form-control my-2 w-100" name='description'
                            placeholder="Course Description" required></textarea>
                    </div>
                    

                    <div class="col-lg-12 col-md-12 col-12 text-center">
                        <button id='submitBtn' name="submit" type="submit" class="btn btn-info">Add Tutorial</button>
                    </div>
                </div>
            </form>
        </div>
        <br>
    </div>

</div>
<script>
    function Enableddl(install) {
        var ddl = document.getElementById("no_of_installment");
        ddl.disabled = install.checked ? false : true;
        if (!ddl.disabled) {
            ddl.focus();
        }
    }

    $(function () {
        $("#no_of_installment").on("change", function () {
            $("#echarges input").prop("disabled", true);
            var selected = $("option:selected", this).map(function () {
                return $(this).text();
            }).toArray();
            var i;
            for (i = 0; i < selected.length; ++i) {
                if (selected[i] == 2)
                // {
                //     $('#echarge1').prop( "disabled", false );
                // }
                // else if(selected[i]==2)
                {
                    $('#echarge2').prop("disabled", false);
                }
                else if (selected[i] == 3) {
                    $('#echarge3').prop("disabled", false);
                }
                else if (selected[i] == 4) {
                    $('#echarge4').prop("disabled", false);
                }
                else if (selected[i] == 5) {
                    $('#echarge5').prop("disabled", false);
                }
                else if (selected[i] == 6) {
                    $('#echarge6').prop("disabled", false);
                }
            }
        });
    });


    $(document).ready(function () {
        $('#no_of_installment').multiselect({
            includeSelectAllOption: true,
        });
    });

    $(".finalcalc").on("change", function () {
        var a, b, c;
        a = Number(document.getElementById("feeamt").value);
        b = Number(document.getElementById("tax").value);
        if (a == undefined) { a = 0; }
        if (b == undefined) { b = 0; }
        c = a + (b / 100) * a;
        $('#final').val(c);
        event.preventDefault()
    });

</script>
<script>
    $("#courseName").on("change", function () {
        $.ajax({
            type: 'POST',
            url: '/addFees/',
            data: {
                'ajax_getinfo': 1,
                "courseName": this.value,
                csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val()
            },
            success: function (response) {
                console.log(response);
                html = ""
                for (i = 0; i < response.classes.length; i++) {
                    html += "<option value=\"" + response.classes[i] + "\">" + response.classes[i] + "</option>";
                }
                $("#forclass").html(html);

                html = ""
                for (i = 0; i < response.teachings.length; i++) {
                    html += "<option value=\"" + response.teachings[i] + "\">" + response.teachings[i] + "</option>";
                }
                $("#check").html(html);

                html = ""
                for (i = 0; i < response.durations.length; i++) {
                    html += "<option value=\"" + response.durations[i] + "\">" + response.durations[i] + "</option>";
                }
                $("#duration").html(html);
            }
        });
    });

    $('#discount').on('change',()=>{
        if ($('#unit').val()==1){
            if($('#cfees').val()){
                $('#discount').prop('max',$('#cfees').val());
            }
        }

        if ($('#discount').val()==0){
            $('#validity').prop('disabled', true);
            $('#validity').prop('required', false);
            $('#validity').val(null);
        }
        
        else{
            $('#validity').prop('disabled', false);
            $('#validity').prop('required', true);
        }
    })

    function selectclass(el) {
        var selected = el.value;
        $.ajax({
            url: "{% url 'findCourse' %}",
            data: {
                forclass: selected,
            },
            success: function (data) {
                courses = data.courses;
                $(".ctn").empty().trigger("change");
                var newOption = new Option(
                        "Select an option",
                        "",
                        false,
                        false
                    );
                    $(".ctn").append(newOption).trigger("change");

                for (i = 0; i < courses.length; i++) {
                    var newOption = new Option(
                        courses[i][1],
                        courses[i][1],
                        false,
                        false
                    );
                    $(".ctn").append(newOption).trigger("change");
                }
            },
        });
    }
    $(document).on('ready', () => {
        if (performance.navigation.type == 2) {
            location.reload();
        }
    });
</script>
{% endblock %}